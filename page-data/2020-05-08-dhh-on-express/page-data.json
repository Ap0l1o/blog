{"componentChunkName":"component---src-components-post-post-jsx","path":"/2020-05-08-dhh-on-express/","result":{"data":{"markdownRemark":{"html":"<p>During GitHub’s annual product announcement on Wednesday, new features to edit\ncode online were demoed. At one point a code snippet was shown from a toy\nweb-app, written in Javascript using the Express server library.</p>\n<p>Here’s the code sample…</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 81.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAACOElEQVQ4y41Ui5KbMBDL/39k0zvC04AxNn5AQKd1mrsknXS6MztxwMhaSXDajwPJLTBVg492Rt0blGrGuRpRXC6oqgreB9zr4P5Dft/0SQC3EGBVj6q3UMOEsukwTgZLiEjripQSYoy4Xq83QDbu/VKnfd+xeg9Tt2Royc6Q5YyyHQncoyguGMcR1tkM+M3yDvzCOgMe3LiRTYwBG9c2rGQX4BeHNZFh5P10ReSehYc/1vHCMgMmGVkbGDNDTxObmhqPUY+YjYM1gdcCBu0wTRrLsmQZHhk+AZqZZlQK1aXFr/MZqlMYaUxd9ujqEf2gUVQtunFGPzko6h3I9GnkP+uT6OKcQ680RhrSdR201rBk6SwfEknYcrCotP/twzNDAQwcuWt7TKOMx7FahZmsFkNg9kQpErUM1HDbNsbI52fE+VeWGXBdt8wy+DW3o0aRxoTI6zTE+g2RgGKIAM6zve0n6I35gymyQW6YydLNRMEdDTH54RTostPY18DwayTvyCo95e8xQj8MtxUNc9g1I1rJ3kWypylDg75roJnDuiww9D0Ue2LoMwlKIfusdSTi8/ok9kvtMopSUE2L2c54V8IiZzf/3tY///fbyFKRwDPj43mSXxKMDdQyUtNIvZZshH+Iyrs6rXxXBVREttbmD0EMGzVM8CERMGU95boA3tm868xQ+tj/ffL/VjZFTi4+KwzdhIZfmo/PAnXdYFAdhuo386nQlWforkTL4MskMpm8gt9TMZOy/gL1id1p+KDWQQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/1f522187bcc3958f4f38bb5e27b193c9/2b93a/express-code-sample.webp 150w,\n/static/1f522187bcc3958f4f38bb5e27b193c9/e93cc/express-code-sample.webp 300w,\n/static/1f522187bcc3958f4f38bb5e27b193c9/3b0a6/express-code-sample.webp 590w\"\n          sizes=\"(max-width: 590px) 100vw, 590px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/1f522187bcc3958f4f38bb5e27b193c9/b8d62/express-code-sample.png 150w,\n/static/1f522187bcc3958f4f38bb5e27b193c9/eed55/express-code-sample.png 300w,\n/static/1f522187bcc3958f4f38bb5e27b193c9/05d41/express-code-sample.png 590w\"\n          sizes=\"(max-width: 590px) 100vw, 590px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/1f522187bcc3958f4f38bb5e27b193c9/05d41/express-code-sample.png\"\n          alt=\"Code sample, written in Javascript, of simple one-file Express-based server for a CRUD web-app.\"\n          title=\"Code sample, written in Javascript, of simple one-file Express-based server for a CRUD web-app.\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n    </span></p>\n<p>After the announcement, David Heinemeier Hansson (DHH), the creator of\nRuby-on-Rails gave his thoughts on Twitter.</p>\n<blockquote class=\"twitter-tweet\"><p lang=\"en\" dir=\"ltr\">Is this really what modern web app development looks like to people these days? We truly are living through the dark ages. The boiler plating, the low-level distractions, the raw pool handling + sql, the configuration situps. Lordy. <a href=\"https://t.co/1sEhWV6il1\">pic.twitter.com/1sEhWV6il1</a></p>&mdash; DHH (@dhh) <a href=\"https://twitter.com/dhh/status/1258074299337826304?ref_src=twsrc%5Etfw\">May 6, 2020</a></blockquote>\n<p>This attracted a lot of commentary from others…</p>\n<blockquote class=\"twitter-tweet\"><p lang=\"en\" dir=\"ltr\">idk what is &quot;dark ages&quot; about access to more powerful and capable APIs, which are more suited towards real-time, low-latency services.<br><br>I&#39;ve used both Ruby on Rails and Node.js professionally before. It&#39;s not even close. Rails is child&#39;s toy compared to Node.js.</p>&mdash; Andrew Kelley (@andy_kelley) <a href=\"https://twitter.com/andy_kelley/status/1258085472104054789?ref_src=twsrc%5Etfw\">May 6, 2020</a></blockquote>\n<p>…and…</p>\n<blockquote class=\"twitter-tweet\"><p lang=\"en\" dir=\"ltr\">I used express and Sinatra in production for years, they are great for API servers. They are inherently less complex hence more performant and easier to debug. You can still build layers of abstractions for your data layer but it&#39;s an opt-in. <a href=\"https://t.co/djl8ZvK6ro\">https://t.co/djl8ZvK6ro</a></p>&mdash; Jaana Dogan (@rakyll) <a href=\"https://twitter.com/rakyll/status/1258749557405446146?ref_src=twsrc%5Etfw\">May 8, 2020</a></blockquote>\n<script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n<p>Of course tweets aren’t long enough to have a balanced discussion about this, so\nlet’s break down in longer form why this code is so controversial and debate\nwhether it should be how we’re developing modern web apps.</p>\n<hr>\n<h3 id=\"whats-wrong-with-express-and-javascript\" style=\"position:relative;\"><a href=\"#whats-wrong-with-express-and-javascript\" aria-label=\"whats wrong with express and javascript permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What’s wrong with Express and Javascript</h3>\n<p>DHH is right to point out that this code is handling a database pool, doing SQL\ntemplating and has low-level HTTP server configuration in it. While these are\nall things necessary for a production service, having them at the same level as\nthe application business logic is usually a bad idea. Separating different\nlevels of the stack into levels of abstraction, and keeping them somewhat\nseparate usually leads to more manageable and testable code.</p>\n<p>The Javascript ecosystem is missing some of the abstractions that are common in\nthe Ruby ecosystem that DHH comes from (or the Python ecosystem that I’m more\nfamiliar with). In my experience, to achieve the level of capability provided\nout of the box by Rails or Django requires many Javascript libraries, a\nsignificant amount of glue code, and extensive testing, and the end result will\nbe a much more brittle and less coherent developer experience.</p>\n<h3 id=\"why-this-doesnt-matter\" style=\"position:relative;\"><a href=\"#why-this-doesnt-matter\" aria-label=\"why this doesnt matter permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Why this doesn’t matter</h3>\n<p>But I think DHH misses the point – that this code sample is almost all the code\nfor this application. Express is great for these sorts of “single file”\napplications. Separation of concerns is important to help developers keep the\nrelevant parts of a system in their head, but if the whole system fits in their\nhead at once because it’s ~10s of lines long, then anything more is\nover-engineering and likely to create more problems than it solves.</p>\n<p>Rails and Django provide many features that all work well together: routing,\ndatabase access, cache access, session management, upload management, storage,\nlogging, email, input validation, security, administration, sitemaps, session\nmessaging, templating, and more.</p>\n<p>Express doesn’t do many of these, at its core it pretty much only does the\nrouting – everything else is some form of add-on. When you need all of those\naspects that’s a problem, but if you only need two or three, then it’s quite\npossible that with Express you’ll end up with a simpler system that works just\nas well. As Jaana Dogan says in her tweet above, you can build only what you\nneed, and will end up with a more understandable and performant system.</p>\n<p>As we move to more use of “microservices”, or focused API driven backends, more\nand more applications will be a good fit for this style.</p>\n<p>DHH is coming to the debate with a bias – he builds Basecamp, a large and\ncomplex monolithic web application that likely uses all of the above aspects and\nmore. In fact Basecamp is complex enough that DHH created Rails specifically to\nhandle this use case. If Basecamp was built with Express it would likely be a\nmess, but because Rails provides solid, and importantly, <em>consistent</em>\nfoundation, I’m sure it’s much more manageable.</p>\n<p>So is the Express example a bad example? No. For a small and simple web app it’s\nreasonable, and for focused APIs and microservices that only need a few aspects\nmentioned above it’s ideal. Those apps of significant complexity will get plenty\nof value out of a framework like Rails or Django, but simpler apps will likely\nbenefit from the lower level design of Express or the buffet-style Javascript\necosystem where you can pick and choose which technologies you actually need.</p>\n<h3 id=\"why-the-hate-for-rails\" style=\"position:relative;\"><a href=\"#why-the-hate-for-rails\" aria-label=\"why the hate for rails permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Why the hate for Rails?</h3>\n<p>So why did DHH see so much backlash against the approach that Rails takes? I\nthink it comes down to the monolithic framework style of Rails (and again of Django).</p>\n<p>These frameworks decide up-front how things are going to work, and then build a\nlot of abstractions on top. Rails is (in)famous for its domain-specific language\nstyle of writing routing logic, database queries, access control, and more.</p>\n<pre class=\"grvsc-container github-plus\" data-language=\"ruby\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"mtk6\">def</span><span class=\"mtk1\"> </span><span class=\"mtk4\">new</span></span>\n<span class=\"grvsc-line\"><span class=\"mtk1\">  @article </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> </span><span class=\"mtk5\">Article</span><span class=\"mtk1\">.</span><span class=\"mtk6\">new</span></span>\n<span class=\"grvsc-line\"><span class=\"mtk6\">end</span></span>\n<span class=\"grvsc-line\"></span>\n<span class=\"grvsc-line\"><span class=\"mtk6\">def</span><span class=\"mtk1\"> </span><span class=\"mtk4\">create</span></span>\n<span class=\"grvsc-line\"><span class=\"mtk1\">  @article </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> </span><span class=\"mtk5\">Article</span><span class=\"mtk1\">.</span><span class=\"mtk6\">new</span><span class=\"mtk1\">(article_params)</span></span>\n<span class=\"grvsc-line\"></span>\n<span class=\"grvsc-line\"><span class=\"mtk1\">  </span><span class=\"mtk6\">if</span><span class=\"mtk1\"> @article.save</span></span>\n<span class=\"grvsc-line\"><span class=\"mtk1\">    redirect_to @article</span></span>\n<span class=\"grvsc-line\"><span class=\"mtk1\">  </span><span class=\"mtk6\">else</span></span>\n<span class=\"grvsc-line\"><span class=\"mtk1\">    render </span><span class=\"mtk7\">&#39;new&#39;</span></span>\n<span class=\"grvsc-line\"><span class=\"mtk1\">  </span><span class=\"mtk6\">end</span></span>\n<span class=\"grvsc-line\"><span class=\"mtk6\">end</span></span></code></pre>\n<p>Here’s an example of what code can look like in a Rails “controller” (an Express\n“handler”, a Django “view”).</p>\n<p>This happens to support returning validation errors back to the client, it uses\nnamed routing so that it doesn’t rely on the exact URLs which is good practice\nin large apps. There’s no SQL, and the ability to use SQL-injection attacks is\nlargely mitigated. It can support default values for fields, and permissions and\nall sorts of other functionality.</p>\n<p>This is great, but there’s a lot of “magic”. You can’t see most of this\nfunctionality, and that means you have to just know that it’s happening. Django\nis slightly less magic, but still does a lot of this for you, compared to\nExpress or similar libraries, it’s roughly the same approach as Rails.</p>\n<p>The reason that there was so much backlash is that because of this magic,\nmonolithic frameworks have a reputation for being inflexible and therefore slow\nto adopt modern technologies (I believe this is what Andrew Kelley was referring\nto in his tweet above).</p>\n<p>This is partially true. In Python there’s a move towards doing I/O in async\noperations to get higher throughput in applications. This is a complex change\nand so Django doesn’t yet support this, despite many smaller Express-style\nlibraries supporting it already.</p>\n<h3 id=\"why-still-use-rails-today\" style=\"position:relative;\"><a href=\"#why-still-use-rails-today\" aria-label=\"why still use rails today permalink\" class=\"header-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Why still use Rails today?</h3>\n<p>While Rails (and Django) may look like a slightly dated ecosystem, and while\nmuch of the web development discourse is trending towards microservices, there\nare many reasons why it’s still a great option today.</p>\n<p>Slower moving doesn’t necessarily mean old and dated. It can mean stable and\nmature. The Javascript ecosystem moves quickly, and while it’s good to get\naccess to cutting edge technology, much of this movement often ends up being\nbusy-work rather than truly value creating for the end product.</p>\n<p>I also think that it’s possible to move faster as a developer with Rails. This <em>really</em> depends on what problem you’re solving, but for your average\nCreate-Retrieve-Update-Delete (CRUD) web application, it’s normally more\nproductive to think at a higher level than concatenating SQL and managing\nconnection pools, instead thinking about relationships between objects that your\nuser understands, and how the user experience (UX) of your application can be\naffected by the workflow you’re developing. Rails is much higher level than\nExpress, and as a result it’s often possible to build and ship much quicker. Not\neverything is a CRUD application, but most web apps are at their core, or at\nleast contain significant amounts of CRUD style code even if it’s not their\nprimary purpose.</p>\n<p>Lastly, I mentioned before that Django in particular was inflexible and slow to\nadopt new technologies, but this is only partially true. One of the things that\ncomes with the maturity of Django (and I’m sure Rails as well) is how extensible\nit is. <em>Many</em> parts of Django can be extended to support new technologies, and\nthere are hooks into many parts of the Django stack to customise how it works.\nThis extensibility isn’t just though the sorts of plugins and middleware that\nExpress supports, but also through allowing the developer to specify the objects\nused to mediate access to almost anything, or through regular class inheritance\nand extension of almost anything in Django – a level of extensibility that is\nrare in the Javascript ecosystem. This is one of the things that makes it so\nsuitable for large codebases – it’s possible to solve <em>most</em> problems in it in\nsome way, without starting from scratch.</p>\n<hr>\n<p>I hope this post sheds some light on the controversial opinions shared on\nTwitter. No one was wrong, but everyone brought their biases of what they’re\nused to working on and the way they prefer to write applications.</p>\n<p>There is no right answer here. Express (… Sinatra, Flask, and others) are\nmuch simpler and that can often be of great benefit to certain kinds of\napplication, but the simple stuff can take a little extra time and in big\ncodebases it’s easy to become unmanageable. Rails (… Django, Phoenix, and\nothers) make most simple things very quick to do and easy to understand, while\npreserving the power for the developer to extend and override, but are unlikely\nto be the first to get cutting edge features and may bring more than is needed\nfor simple applications.</p>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n  }\n  \n  .grvsc-code {\n    display: inline-block;\n    min-width: 100%;\n  }\n  \n  .grvsc-line {\n    display: inline-block;\n    box-sizing: border-box;\n    width: 100%;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-line-highlighted {\n    background-color: var(--grvsc-line-highlighted-background-color, transparent);\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, transparent);\n  }\n  \n  .github-plus {\n    background-color: #ffffff;\n    color: #24292e;\n  }\n  .github-plus .mtk6 { color: #D73A49; }\n  .github-plus .mtk1 { color: #24292EFF; }\n  .github-plus .mtk4 { color: #6F42C1; }\n  .github-plus .mtk5 { color: #005CC5; }\n  .github-plus .mtk7 { color: #22863A; }\n</style>","fields":{"slug":"/2020-05-08-dhh-on-express/"},"frontmatter":{"title":"Is this what modern web development is?","theme":null,"originally_on_thread":null,"date":"08 May, 2020"}},"site":{"siteMetadata":{"title":"Dan Palmer","description":"Personal site and blog"}}},"pageContext":{"slug":"/2020-05-08-dhh-on-express/"}}}